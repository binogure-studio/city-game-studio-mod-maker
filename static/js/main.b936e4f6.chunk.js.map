{"version":3,"sources":["index.js"],"names":["App","props","handleSubmit","bind","formData","zip","JSZip","cloned_data","JSON","parse","stringify","formatData","_data","_ui_schema","Array","isArray","forEach","item","items","Object","keys","key","array","reduce","acc","label","translation","filename","split","replace","file","dataURI","byteString","atob","ab","ArrayBuffer","length","ia","Uint8Array","i","charCodeAt","Blob","dataURItoBlob","ui_schema","generateAsync","type","then","base64","downloadAnchorNode","document","createElement","setAttribute","body","appendChild","click","remove","schema","uiSchema","onSubmit","this","class","value","Component","ReactDOM","render","getElementById"],"mappings":"u10CAyBqBA,E,kDACnB,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IACDC,aAAe,EAAKA,aAAaC,KAAlB,gBAFH,E,4DAKO,IAAZC,EAAW,EAAXA,SACRC,EAAM,IAAIC,IACVC,EAAcC,KAAKC,MAAMD,KAAKE,UAAUN,KAEzB,SAAbO,EAAcC,EAAOC,GAErBC,MAAMC,QAAQH,GAChBA,EAAMI,SAAQ,SAACC,GAAD,OAAUN,EAAWM,EAAMJ,EAAWK,UAEpDC,OAAOC,KAAKR,GAAOI,SAAQ,SAACK,GAC1B,GAAkB,MAAdR,GAAyC,MAAnBA,EAAWQ,SAE9B,GAA6B,MAAzBR,EAAWQ,GAAKH,OAAiBL,EAAWQ,GAAKH,MAAMI,MAChEV,EAAMS,GAAOT,EAAMS,GAAKE,QAAO,SAACC,EAAKP,GAGnC,OAFAO,EAAIP,EAAKQ,OAASR,EAAKS,YAEhBF,IACN,SACE,GAAqC,MAAjCX,EAAWQ,GAAK,cAAuB,CAEhD,IACIM,EADYf,EAAMS,GAAKO,MAAM,KACR,GAAGC,QAAQ,QAAS,IAE7CxB,EAAIyB,KAAKH,EA9CrB,SAAuBI,GASrB,IANA,IAAIC,EAAaC,KAAKF,EAAQH,MAAM,KAAK,IAGrCM,EAAK,IAAIC,YAAYH,EAAWI,QAChCC,EAAK,IAAIC,WAAWJ,GAEfK,EAAI,EAAGA,EAAIP,EAAWI,OAAQG,IACrCF,EAAGE,GAAKP,EAAWQ,WAAWD,GAIhC,OAAO,IAAIE,KAAK,CAACP,IAgCYQ,CAAc9B,EAAMS,KACvCT,EAAMS,GAAOM,OAEbhB,EAAWC,EAAMS,GAAMR,EAAWQ,OAO1CV,CAAWJ,EAAaoC,GAExBtC,EAAIyB,KAAK,WAAYtB,KAAKE,UAAUH,EAAa,KAAM,IACvDF,EAAIuC,cAAc,CAACC,KAAM,WAAYC,MAAK,SAACC,GACzC,IAAIC,EAAqBC,SAASC,cAAc,KAEhDF,EAAmBG,aAAa,OAAQ,+BAAiCJ,GACzEC,EAAmBG,aAAa,WAAY,WAC5CF,SAASG,KAAKC,YAAYL,GAC1BA,EAAmBM,QACnBN,EAAmBO,c,+BAKrB,OACE,cAAC,IAAD,CAAMC,OAAQA,EAAQC,SAAUd,EAAWe,SAAUC,KAAKzD,aAA1D,SACE,wBAAQ0D,MAAM,eAAef,KAAK,SAASgB,MAAM,WAAjD,4B,GAxDyBC,aA8DjCC,IAASC,OAAO,cAAChE,EAAD,IAASiD,SAASgB,eAAe,W","file":"static/js/main.b936e4f6.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport JSZip from 'jszip';\nimport Form from '@rjsf/core';\n\nimport schema from './schemas.json';\nimport ui_schema from './ui-schemas.json';\n\nfunction dataURItoBlob(dataURI) {\n  // convert base64 to raw binary data held in a string\n  // doesn't handle URLEncoded DataURIs - see SO answer #6850276 for code that does this\n  var byteString = atob(dataURI.split(',')[1]);\n\n  // write the bytes of the string to an ArrayBuffer\n  var ab = new ArrayBuffer(byteString.length);\n  var ia = new Uint8Array(ab);\n\n  for (var i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i)\n  }\n\n  // write the ArrayBuffer to a blob, and you're done\n  return new Blob([ab])\n}\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleSubmit({formData}) {\n    let zip = new JSZip()\n    let cloned_data = JSON.parse(JSON.stringify(formData));\n\n    const formatData = (_data, _ui_schema) => {\n\n      if (Array.isArray(_data)) {\n        _data.forEach((item) => formatData(item, _ui_schema.items))\n      } else {\n        Object.keys(_data).forEach((key) => {\n          if (_ui_schema == null || _ui_schema[key] == null) {\n            // NO-OP\n          } else if (_ui_schema[key].items != null && _ui_schema[key].items.array) {\n            _data[key] = _data[key].reduce((acc, item) => {\n              acc[item.label] = item.translation\n\n              return acc\n            }, {})\n          } else if (_ui_schema[key]['ui:options'] != null) {\n            // It is a file\n            let file_data = _data[key].split(';')\n            let filename = file_data[1].replace('name=', '')\n\n            zip.file(filename, dataURItoBlob(_data[key]))\n            _data[key] = filename\n          } else {\n            formatData(_data[key], _ui_schema[key])\n          }\n        })\n      }\n    }\n\n    // Reformat the data\n    formatData(cloned_data, ui_schema)\n\n    zip.file('mod.json', JSON.stringify(cloned_data, null, 2))\n    zip.generateAsync({type :\"base64\"} ).then((base64) => {\n      let downloadAnchorNode = document.createElement(\"a\")\n\n      downloadAnchorNode.setAttribute(\"href\", \"data:application/zip;base64,\" + base64)\n      downloadAnchorNode.setAttribute(\"download\", \"mod.zip\")\n      document.body.appendChild(downloadAnchorNode)\n      downloadAnchorNode.click()\n      downloadAnchorNode.remove()\n    })\n  }\n\n  render() {\n    return (\n      <Form schema={schema} uiSchema={ui_schema} onSubmit={this.handleSubmit} >\n        <button class=\"btn btn-info\" type=\"submit\" value=\"Download\">Download</button>\n      </Form>\n    )\n  }\n}\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}